C51 COMPILER V9.54   LED                                                                   05/27/2018 02:46:11 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN .\Objects\led.obj
COMPILER INVOKED BY: E:\Keil\C51\BIN\C51.EXE led.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\led.lst)
                    - TABS(2) OBJECT(.\Objects\led.obj)

line level    source

   1          
   2          #include<reg52.h>    
   3          #include <intrins.h> 
   4          #define uchar unsigned char
   5          #define uint unsigned int
   6          
   7          
   8          sbit D=P1^5; //Pin14 ????
   9          sbit Out=P1^6 ;//Pin12 RCLK 锁存器输出
  10          sbit SRCLK=P1^7;  // Pin11 SRCLK 数据输入
  11          sbit  OutA=P1^3;  //154 上16行控制  0使能输出
  12          sbit  OutB=P1^4;  // 154 下16行控制 0
  13          sbit  KEY=P1^2;
  14          
  15          unsigned char code LED4[]={
  16            /* 子*/
  17            0xFF,0xFF,0xC0,0x0F,0xFF,0xEF,0xFF,0xDF,0xFF,0xBF,0xFE,0x7F,0xFE,0xFF,0x00,0x01,
  18            0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFA,0xFF,0xFC,0xFF
  19          };
  20          
  21          unsigned char code LED3[]={
  22            0xFD,0xFF,0xFD,0xFF,0xFD,0xFF,0x80,0x0F,0xBD,0xEF,0xBD,0xEF,0x80,0x0F,0xBD,0xEF,
  23            0xBD,0xEF,0x80,0x0F,0xFD,0xFF,0xFD,0xFF,0xFD,0xFB,0xFD,0xFB,0xFC,0x03,0xFF,0xFF
  24          };
  25          
  26          unsigned char code LED2[]={
  27          0xFF,0xFF,0xFF,0xFF,0x80,0x03,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,
  28          0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0xFE,0xFF,0x00,0x01,0xFF,0xFF,0xFF,0xFF};
  29          
  30          
  31          unsigned char code LED1[]={
  32          0xBE,0xBF,0xCE,0xDF,0xEE,0xFB,0xFC,0x01,0x79,0xDF,0x95,0xD7,0xDC,0x03,0xF5,0xDF,
  33          0xED,0xD7,0xDC,0x03,0x1D,0xDF,0xDD,0xDF,0xDD,0xDB,0xDC,0x01,0xDD,0xFF,0xDD,0xFF};
  34          
  35          
  36          unsigned int Data=0xAA;
  37          
  38          void Delay(uint n)   // 延时毫秒
  39          {
  40   1         uchar i;
  41   1         while(n--)
  42   1         {
  43   2           for(i=0;i<120;i++);
  44   2      }
  45   1      }
  46          
  47          // 595 调用函数
  48          void HC595SendData (unsigned int SendVal)
  49          {
  50   1        int i;
  51   1        for(i=0;i<8;i++)
  52   1        {
  53   2          if(((SendVal << i)&0x80) !=0)
  54   2              D=1;
C51 COMPILER V9.54   LED                                                                   05/27/2018 02:46:11 PAGE 2   

  55   2           else 
  56   2             D=0;
  57   2           SRCLK=0;
  58   2           Delay(0);
  59   2           SRCLK=1;
  60   2        }
  61   1          // Out=0;
  62   1          // Out=1;
  63   1      }
  64          
  65          /*完整显示函数 输入 变量从哪一行开始*/
  66              void ShowLed(unsigned int Line)
  67              {
  68   1            int i;
  69   1              OutA=0;
  70   1            for(i=0;i<16;i++,Line++)
  71   1            {
  72   2              P0=Line;
  73   2              HC595SendData(LED2[2*i+1]);  // 给32位数据
  74   2              HC595SendData(LED2[2*i]);
  75   2              HC595SendData(LED1[2*i+1]);
  76   2              HC595SendData(LED1[2*i]);
  77   2              Out=0;   //数据输入
  78   2              Out=1;
  79   2              Delay(7);
  80   2            }
  81   1            OutA=1;
  82   1            OutB=0;
  83   1            Line -=0x10;
  84   1            for(i=0;i<16;i++,Line+=0x10)
  85   1            {
  86   2              
  87   2              P0=Line;
  88   2              HC595SendData(LED4[2*i+1]);  // 给32位数据
  89   2              HC595SendData(LED4[2*i]);
  90   2              HC595SendData(LED3[2*i+1]);
  91   2              HC595SendData(LED3[2*i]);
  92   2              Out=0;   //数据输入
  93   2              Out=1;
  94   2              Delay(7);
  95   2            }
  96   1          OutB=1;
  97   1          
  98   1          }
  99              
 100          
 101          
 102          void main()
 103          {
 104   1        int Line;
 105   1      
 106   1        KEY=1;
 107   1          while(1){
 108   2            Line=0x00;
 109   2            ShowLed(Line);
 110   2            if(!KEY){
 111   3            
 112   3              }
 113   2          }
 114   1        
 115   1      }
 116          
C51 COMPILER V9.54   LED                                                                   05/27/2018 02:46:11 PAGE 3   

 117          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    377    ----
   CONSTANT SIZE    =    128    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
